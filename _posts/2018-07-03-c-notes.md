---
title: Intermediate to Advanced C Programming Notes
date: 2018-07-03
icon: code
category: Coding
tags: [Coding, C Language]
---

## Stack and Heap

Remember the difference between Stack and Heap by remembering "The heap is a heap of a pain."

### Stack

Region of computer's memory that stores **temporary** variables.

Memory is managed **for you automatically**.

Is a "LIFO" (Last in first out) data strucutre and is managed by the CPU.

Whenever a function declares a variable, it is pushed to the stack. Whenever the function exits, the variables are freed.

### Heap

The heap is the region of memory that is not managed automatically.

You are responsible for freeing memory by using the free() function.

### Pros and Cons of Stack and Heap

If you are dealing with relatively small variables that only need to exist as long as the function is running, then the stack is a good choice.

You should use the heap when you have to allocate a large block of memory that needs to be around for a long time.

Also if you want to use variables such as arrays and structs and would like to dynamically change their size, the heap is the way to go.

#### Stack

Pros:

- Don't have to worry about freeing memory you allocate. It is done for you.

Cons:

- Variables can only be accessed locally
- Variables cannot be resized

##### Example Stack Program

{% highlight c %}
#include <stdio.h>

int main() {
	int age = 30;

	printf("you are %i years old.", *age);
}
{% endhighlight %}

#### Heap

Pros:

- Variables can be accessed globally
- No limit on memory size
- Variables can be resized using realloc()

Cons:

- (relatively) slower access
- no guaranteed efficient use of space, memory may become fragmented over time as blocks of memory are allocated, then freed
- you must manage memory (you're in charge of allocating and freeing variables)

##### Example Heap Program

{% highlight c %}
#include <stdio.h>
#include <stdlib.h>

int main() {
	int *age = malloc(sizeof(int));
	*age = 30;
	
	printf("you are %i years old.", *age);
	free(age); // Very important that you free variables on the heap!
}
{% endhighlight %}

### Further Reading

[Stack vs. Heap - GribbleLab.org](https://www.gribblelab.org/CBootCamp/7_Memory_Stack_vs_Heap.html)

## Detecting leaks easily

To detect leaks, you can use the program, Valgrind.

Usage: `valgrind --leak-check=full ./app`
